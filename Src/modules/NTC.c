/*******************************************************************************
 * 文件名  ：RTC.c
 * 描述    ：delay应用函数库        
 * 库版本  ：ST3.5.0
**********************************************************************************/
#include "ntc.h"

//-40 ~ 125 °  135k ~ 553
const uint32_t c_ntc_resistance[156]={
1354534, 1278382, 1207081, 1140288, 1077687, 1018987,	963918,	912229,	863692,	818091,	775231,734927,	
697010,	661322,	627719,	596064,	566231,	538104,	511573,	486538,	462905,	440586,	419499,	399569,	
380724,	362899,	346031,	330064,	314944,	300619,	287045,	274175,	261970,	250390,	239401,	228968,	
219059,	209645,	200699,	192194,	184105,	176411,	169088,	162118,	155480,	149157,	143133,	137391,	
131917,	126695,	121714,	116961,	112424,	108092,	103954,	100000,	96222,	92611,	89157,	85854,	
82694,	79670,	76775,	74004,	71349,	68806,	66369,	64034,	61795,	59647,	57588,	55611,
53715,	51895,	50147,	48469,	46856,	45307,	43819,	42388,	41012,	39689,	38416,	37192,	
36013,	34879,	33787,	32736,	31724,	30748,	29808,	28903,	28029,	27188,	26376,	25593,
24838,	24109,	23406,	22727,	22072,	21439,	20828,	20238,	19667,	19116,	18584,	18069,	
17571,	17090,	16624,	16174,	15738,	15316,	14908,	14513,	14131,	13760,	13402,	13054,
12718,	12392,	12076,	11769,	11472,	11184,	10905,	10635,	10372,	10117,	9870,	9630,	
9397,	9171,	8952,	8739,	8532,	8331,	8136,	7946,	7762,	7583,	7409,	7240,
7075,	6915,	6760,	6609,	6461,	6318,	6179,	6044,	5912,	5783,	5659,	5537,
} ;//ohm

int16_t updata_ntc_temp_value(uint32_t res_measured)
{
    uint8_t up = 155;
    uint8_t buttom = 0;
    uint8_t middle;
    int16_t temperature;	//unit=0.1 Centigrade 

    if (res_measured > c_ntc_resistance[0]){
        res_measured = c_ntc_resistance[0];
		}
    else if (res_measured < c_ntc_resistance[155]){
        res_measured = c_ntc_resistance[155];
		}
    while(up != buttom+1){
        middle = (uint8_t)(up + buttom) / 2;
        if (res_measured < c_ntc_resistance[middle]){
            buttom = middle;
				}
				else{
            up = middle;
				}
    }
    temperature = buttom * 10 - 400 + (res_measured - c_ntc_resistance[buttom])*10 / (c_ntc_resistance[up] - c_ntc_resistance[buttom]);	
    return temperature;
}





